@model IEnumerable<CumulativeProject3.Models.Teacher>
@{
    ViewBag.Title = "Teachers";
}

<div id="containerlist">
    <div class="row mb-5">
        <div class="col-md-10">
            <h2>List of Teachers</h2>
        </div>
        <div class="col-md-2">
            <a href="/Teacher/Add" class="btn btn-success btn-block">Add Teacher</a>
        </div>
    </div>

    @foreach (var teacher in Model)
    {
        <div class="listitem row my-1" id="teacher-@teacher.teacherId">
            <div class="col-md-10">
                <a href="/Teacher/Show/@teacher.teacherId">@teacher.teacherFname @teacher.teacherLname</a>
            </div>
            <div class="col-md-1">
                <a href="/Teacher/Update/@teacher.teacherId" class="btn btn-sm btn-primary btn-block">Update</a>
            </div>
            <div class="col-md-1">
                <button onclick="deleteTeacher(@teacher.teacherId)" class="btn btn-sm btn-danger btn-block">Delete</button>
            </div>
        </div>
    }
</div>

<script>
    function deleteTeacher(teacherId) {
        if (!confirm("Are you sure you want to delete this teacher?")) {
            return;
        }
        
        const xhr = new XMLHttpRequest();
                    xhr.open("DELETE", "/api/TeacherData/DeleteTeacher/" + teacherId, true);
                    xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === XMLHttpRequest.DONE) {
                            if (xhr.status === 200) {
                                // Teacher deleted successfully, remove from UI
                                const listItem = document.getElementById('teacher-' + teacherId);
                                if (listItem) {
                                    listItem.remove();
                                }
                               
                                alert("Teacher deleted successfully.");
                            } else {
                                // Handle error
                                alert("Error deleting teacher");
                            }
                        }
                    };
                    xhr.send();
    }
</script>